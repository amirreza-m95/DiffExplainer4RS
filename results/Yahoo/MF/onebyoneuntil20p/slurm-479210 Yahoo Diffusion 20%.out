Starting embedding diffusion evaluation for yahoo dataset...
Evaluation method: onebyoneuntil20p
Test data path: datasets/lxr-CE/Yahoo/test_data_Yahoo.csv
VAE checkpoint path: checkpoints/recommenders/VAE/VAE_Yahoo_0_32_256newbest.pt
Diffusion model path: checkpoints/diffusionModels/diffusion_transformer_yahoo_best.pth
User history dimension: 4604
Timesteps: 100
Guidance lambda: 2.5
Loaded 2760 test users
Starting evaluation on 2760 test users...
Processing user 0/2760

=== Embedding Diffusion Evaluation Results ===
Number of users evaluated: 2760
Dataset: YAHOO, Recommender: VAE
Evaluation method: onebyoneuntil20p

One-by-One Until 20% Evaluation Results:
Maximum removal steps across all users (up to 20%): 57

Average Metrics at Key Steps:
Step 0 (remove 0 items):
  DEL: 0.0321, INS: 0.0058, NDCG: 1.0000
  POS@1: 1.0000, POS@3: 1.0000, POS@5: 1.0000, POS@10: 1.0000
  NEG@1: 1.0000, NEG@3: 1.0000, NEG@5: 1.0000, NEG@10: 1.0000
Step 1 (remove 1 items):
  DEL: 0.0273, INS: 0.0296, NDCG: 0.7593
  POS@1: 0.4975, POS@3: 0.8779, POS@5: 0.9315, POS@10: 0.9681
  NEG@1: 0.7514, NEG@3: 0.9399, NEG@5: 0.9710, NEG@10: 0.9877
Step 2 (remove 2 items):
  DEL: 0.0209, INS: 0.0314, NDCG: 0.7154
  POS@1: 0.4135, POS@3: 0.8373, POS@5: 0.9365, POS@10: 0.9836
  NEG@1: 0.7590, NEG@3: 0.9556, NEG@5: 0.9896, NEG@10: 0.9984
Step 3 (remove 3 items):
  DEL: 0.0179, INS: 0.0323, NDCG: 0.6528
  POS@1: 0.3358, POS@3: 0.7281, POS@5: 0.8858, POS@10: 0.9633
  NEG@1: 0.7437, NEG@3: 0.9470, NEG@5: 0.9796, NEG@10: 0.9980
Step 4 (remove 4 items):
  DEL: 0.0157, INS: 0.0310, NDCG: 0.6123
  POS@1: 0.2948, POS@3: 0.6525, POS@5: 0.8318, POS@10: 0.9499
  NEG@1: 0.7315, NEG@3: 0.9354, NEG@5: 0.9745, NEG@10: 0.9932
Step 5 (remove 5 items):
  DEL: 0.0141, INS: 0.0303, NDCG: 0.5836
  POS@1: 0.2679, POS@3: 0.5877, POS@5: 0.7882, POS@10: 0.9398
  NEG@1: 0.7352, NEG@3: 0.9294, NEG@5: 0.9678, NEG@10: 0.9927
Step 6 (remove 6 items):
  DEL: 0.0129, INS: 0.0304, NDCG: 0.5564
  POS@1: 0.2535, POS@3: 0.5437, POS@5: 0.7364, POS@10: 0.9138
  NEG@1: 0.7300, NEG@3: 0.9290, NEG@5: 0.9658, NEG@10: 0.9937
Step 7 (remove 7 items):
  DEL: 0.0118, INS: 0.0284, NDCG: 0.5430
  POS@1: 0.2364, POS@3: 0.5241, POS@5: 0.7076, POS@10: 0.8974
  NEG@1: 0.6921, NEG@3: 0.9207, NEG@5: 0.9549, NEG@10: 0.9907
Step 8 (remove 8 items):
  DEL: 0.0110, INS: 0.0275, NDCG: 0.5350
  POS@1: 0.2351, POS@3: 0.5299, POS@5: 0.6859, POS@10: 0.8825
  NEG@1: 0.7052, NEG@3: 0.9133, NEG@5: 0.9576, NEG@10: 0.9865
Step 9 (remove 9 items):
  DEL: 0.0104, INS: 0.0264, NDCG: 0.5184
  POS@1: 0.2159, POS@3: 0.5273, POS@5: 0.6659, POS@10: 0.8614
  NEG@1: 0.7000, NEG@3: 0.9068, NEG@5: 0.9455, NEG@10: 0.9864
Step 10 (remove 10 items):
  DEL: 0.0099, INS: 0.0249, NDCG: 0.5056
  POS@1: 0.2162, POS@3: 0.4973, POS@5: 0.6595, POS@10: 0.8405
  NEG@1: 0.7027, NEG@3: 0.8973, NEG@5: 0.9514, NEG@10: 0.9811
Step 15 (remove 15 items):
  DEL: 0.0082, INS: 0.0209, NDCG: 0.4672
  POS@1: 0.2036, POS@3: 0.4551, POS@5: 0.5928, POS@10: 0.7844
  NEG@1: 0.6467, NEG@3: 0.8623, NEG@5: 0.8982, NEG@10: 0.9521
Step 20 (remove 20 items):
  DEL: 0.0071, INS: 0.0181, NDCG: 0.4272
  POS@1: 0.1667, POS@3: 0.3929, POS@5: 0.5119, POS@10: 0.7500
  NEG@1: 0.6190, NEG@3: 0.8452, NEG@5: 0.8810, NEG@10: 0.9286
Step 25 (remove 25 items):
  DEL: 0.0067, INS: 0.0162, NDCG: 0.4295
  POS@1: 0.2093, POS@3: 0.3488, POS@5: 0.5349, POS@10: 0.7209
  NEG@1: 0.5814, NEG@3: 0.8372, NEG@5: 0.8837, NEG@10: 0.9070
Step 30 (remove 30 items):
  DEL: 0.0059, INS: 0.0122, NDCG: 0.4156
  POS@1: 0.2500, POS@3: 0.4167, POS@5: 0.5417, POS@10: 0.5833
  NEG@1: 0.6250, NEG@3: 0.8333, NEG@5: 0.8750, NEG@10: 0.9167
Step 50 (remove 50 items):
  DEL: 0.0060, INS: 0.0030, NDCG: 0.5000
  POS@1: 0.5000, POS@3: 0.5000, POS@5: 0.5000, POS@10: 0.5000
  NEG@1: 1.0000, NEG@3: 1.0000, NEG@5: 1.0000, NEG@10: 1.0000

Results saved to: embedding_diffusion_eval_results_yahoo_onebyoneuntil20p.pkl
